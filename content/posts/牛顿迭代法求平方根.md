---
title: 牛顿迭代法求平方根
comment: false
categories: ["算法"]
tags:
  - 算法
date: 2021-06-30 22:39:00
cover:
---

# 牛顿迭代法求平方根

牛顿迭代法求平方根，这种方法可以很有效地求出根号a的近似值：

首先随便猜一个近似值x，然后不断令x等于x和a/x的平均数，迭代个六七次后x的值就已经相当精确了。

> 例如，我想求根号2等于多少。假如我猜测的结果为4，虽然错的离谱，但你可以看到使用牛顿迭代法后这个值很快就趋近于根号2了：

;;;info

(    4 + 2/  4   ) / 2 = 2.25
(  2.25 + 2/  2.25 ) / 2 = 1.56944..
( 1.56944..+ 2/1.56944..) / 2 = 1.42189..
( 1.42189..+ 2/1.42189..) / 2 = 1.41423..
….

;;;

![](http://www.matrix67.com/blogimage/200711241.gif)

原理其实很简单，我们仅仅是不断用(x,f(x))的切线来逼近方程x^2-a=0的根。

根号a实际上就是x^2-a=0的一个正实根，这个函数的导数是2x。

也就是说，函数上任一点(x,f(x))处的切线斜率是2x。那么，x-f(x)/(2x)就是一个比x更接近的近似值。

代入f(x)=x^2-a得到x-(x^2-a)/(2x)，也就是(x+a/x)/2。

> java代码实现如下

```java
public static double sqrt(double c) {
    if(c < 0) {
        return Double.NaN;
    }
    
    double err = 1e-15;
    double x = c;
    // 循环条件为上一次值和这次值的差，小于一个阈值(误差范围)退出
    while(Math.abs(x - c/x) > err * x) { 
        x = (c/x + x) / 2.0;
    }
    
    return x;
}
```

参考自：http://www.matrix67.com/blog/archives/361
